module.exports = app => {
    const User = app.models.User;

    return Action({
        execute: (context) => {
            return User
                .findById(context.token.user.id)
                .where(context.criteria.where)
                .select(context.criteria.fields)
                .skip(context.criteria.skip)
                .limit(context.criteria.limit)
                .sort(context.criteria.sort)
                .populate('projects profile')
                .then(Utils.ensureOne({code: 404, reason: 'user.not.found'}));
        }
    });
};