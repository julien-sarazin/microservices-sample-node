FROM node:6.11

# Default Environement configuration
ARG NODE_ENV=development
ARG MAILER_API=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
ARG PORT=3000
ARG SALT=jEuZDJxAEDzegcazr
ARG REALM=auth
ARG LOGGER_LEVEL=tiny

ENV NODE_ENV=$NODE_ENV
ENV MAILER_API=$MAILER_API
ENV PORT=$PORT
ENV SALT=$SALT
ENV LOGGER_LEVEL=$LOGGER_LEVEL

# Create workspace directories
WORKDIR /workspace

# Copy sources files into image
COPY . /workspace

# Install Global dependecies
RUN npm install -g pm2

# Install dependencies
RUN npm i
# Build Documentation
RUN npm run docs

# Starts admin
CMD ["pm2-docker", "process.yml"]

# Exposing the default port
EXPOSE $PORT


